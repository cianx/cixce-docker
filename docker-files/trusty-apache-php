FROM ubuntu:trusty
MAINTAINER cian@cixce.com

RUN apt-get update \
 && apt-get install -y -q --no-install-recommends \
    curl \
    ca-certificates \
    build-essential \
    libkrb5-dev \
    libssl-dev \
    apache2 \
    php5 \
    php5-cli \
    php5-mysqlnd \
    php5-gd \
    php5-imagick \
    php5-curl \
    librsvg2-bin \
    inkscape \
    imagemagick \
    libmagickcore5-extra \
    libapache2-mod-php5

# && apt-get -y build-dep imagemagick
#&& apt-get -y remove --purge *-dev \
# && apt-get clean \
# && rm -rf /var/lib/apt/lists/*

RUN groupadd -g 6879 cixce \
 && useradd -u 6879 -g 6879 -ms /bin/bash cixce \
 && usermod -aG www-data cixce \
 && mkdir /app \
 && chown cixce.cixce /app \
 && rm -rf /var/www/html \
 && ln -s /app /var/www/html

WORKDIR /app

EXPOSE 80
CMD ["apachectl", "-D", "FOREGROUND"]
